I"ê<p>INIå°±æ˜¯æ‰©å±•åä¸ºâ€INIâ€çš„æ–‡ä»¶,å…¶å®ä»–æœ¬èº«æ˜¯ä¸ªæ–‡æœ¬æ–‡ä»¶,å¯ä»¥ç”¨è®°äº‹æœ¬æ‰“å·¥,ä¸»è¦å­˜æ”¾çš„æ˜¯ç”¨æˆ·æ‰€åšçš„é€‰æ‹©æˆ–ç³»ç»Ÿçš„å„ç§å‚æ•°.<br />
INIæ–‡ä»¶å…¶å®å¹¶ä¸æ˜¯æ™®é€šçš„æ–‡æœ¬æ–‡ä»¶.å®ƒæœ‰è‡ªå·±çš„ç»“æ„.ç”±è‹¥å¹²æ®µè½(SECTION)ç»„æˆ,åœ¨æ¯ä¸ªå¸¦æ‹¬å·çš„æ ‡é¢˜ä¸‹é¢,æ˜¯è‹¥å¹²ä¸ªä»¥å•ä¸ªå•è¯å¼€å¤´çš„å…³é”®å­—(KEYWORD)å’Œä¸€ä¸ªç­‰å·,ç­‰å·å³è¾¹å°±æ˜¯å…³é”®å­—çš„å€¼(VALUE).ä¾‹å¦‚:<br />
[Section1]<br />
KeyWord1 = Value1<br />
KeyWord2 = Value2<br />
â€¦&lt;br /&gt;
[Section2]<br />
KeyWord3 = Value3<br />
KeyWord4 = Value4</p>
<p>
	C#å‘½åç©ºé—´ä¸­æ²¡æœ‰ç›´æ¥è¯»å†™INIçš„ç±»,å½“ç„¶å¦‚æœä½ æŠŠINTå½“æˆæ–‡æœ¬æ–‡ä»¶ç”¨System.IOç±»æ¥è¯»å†™ç®—æˆ‘æ²¡è¯´.<br />
æˆ‘ç°åœ¨ä»‹ç»çš„æ˜¯ç³»ç»Ÿå¤„ç†INIçš„æ–¹æ³•.<br />
è™½ç„¶C#ä¸­æ²¡æœ‰,ä½†æ˜¯åœ¨â€kernel32.dllâ€è¿™ä¸ªæ–‡ä»¶ä¸­æœ‰Win32çš„APIå‡½æ•°â€“WritePrivateProfileString()å’ŒGetPrivateProfileString()<br />
C#å£°æ˜INIæ–‡ä»¶çš„å†™æ“ä½œå‡½æ•°WritePrivateProfileString():
</p>
<p>
	<span style="color:#FF0000;">[DllImport( "kernel32"&nbsp; )]</span><br />
<span style="color:#FF0000;">private static extern long&nbsp; WritePrivateProfileString ( string section ,string key , string&nbsp; val</span><br />
<span style="color:#FF0000;">, string filePath )&nbsp; ;</span> 
</p>
<p>
	å‚æ•°è¯´æ˜ï¼šsectionï¼šINIæ–‡ä»¶ä¸­çš„æ®µè½ï¼›keyï¼šINIæ–‡ä»¶ä¸­çš„å…³é”®å­—ï¼›valï¼šINIæ–‡ä»¶ä¸­å…³é”®å­—çš„æ•°å€¼ï¼›filePathï¼šINIæ–‡ä»¶çš„å®Œæ•´çš„è·¯å¾„å’Œåç§°ã€‚&lt;br /&gt;
Cï¼ƒç”³æ˜INIæ–‡ä»¶çš„è¯»æ“ä½œå‡½æ•°GetPrivateProfileString():
</p>
<p>
	<span style="color:#FF0000;">[DllImport("kernel32")]</span><br />
<span style="color:#FF0000;">private static extern int GetPrivateProfileString&nbsp; ( string section ,</span><br />
<span style="color:#FF0000;">string key ,&nbsp; string def , StringBuilder retVal ,</span><br />
<span style="color:#FF0000;">int&nbsp; size , string filePath ) ;</span> 
</p>
<p>
	å‚æ•°è¯´æ˜ï¼šsectionï¼šINIæ–‡ä»¶ä¸­çš„æ®µè½åç§°ï¼›keyï¼šINIæ–‡ä»¶ä¸­çš„å…³é”®å­—ï¼›defï¼šæ— æ³•è¯»å–æ—¶å€™æ—¶å€™çš„ç¼ºçœæ•°å€¼ï¼›retValï¼šè¯»å–æ•°å€¼ï¼›sizeï¼šæ•°å€¼çš„å¤§å°ï¼›filePathï¼šINIæ–‡ä»¶çš„å®Œæ•´è·¯å¾„å’Œåç§°ã€‚
</p>
<p>
	ä¸‹é¢æ˜¯ä¸€ä¸ªè¯»å†™INIæ–‡ä»¶çš„ç±»:
</p>
<pre class="prettyprint lang-cs">public class INIClass
    {
        public string inipath;
        [DllImport("kernel32")]
        private static extern long WritePrivateProfileString(string section, string key, string val, string filePath);
        [DllImport("kernel32")]
        private static extern int GetPrivateProfileString(string section, string key, string def, StringBuilder retVal, int size, string filePath);
        /// &lt;summary&gt;
        /// æ„é€ æ–¹æ³•
        /// &lt;/summary&gt;
        /// &lt;param name="INIPath"&gt;æ–‡ä»¶è·¯å¾„&lt;/param&gt;
        public INIClass(string INIPath)
        {
            inipath = INIPath;
        }
        /// &lt;summary&gt;
        /// å†™å…¥INIæ–‡ä»¶
        /// &lt;/summary&gt;
        /// &lt;param name="Section"&gt;é¡¹ç›®åç§°(å¦‚ [TypeName] )&lt;/param&gt;
        /// &lt;param name="Key"&gt;é”®&amp;lt;/param&gt;
        /// &lt;param name="Value"&gt;å€¼&amp;lt;/param&gt;
        public void IniWriteValue(string Section, string Key, string Value)
        {
            WritePrivateProfileString(Section, Key, Value, this.inipath);
        }
        /// &lt;summary&gt;
        /// è¯»å‡ºINIæ–‡ä»¶
        /// &lt;/summary&gt;
        /// &lt;param name="Section"&gt;é¡¹ç›®åç§°(å¦‚ [TypeName] )&lt;/param&gt;
        /// &lt;param name="Key"&gt;é”®&amp;lt;/param&gt;
        public string IniReadValue(string Section, string Key)
        {
            StringBuilder temp = new StringBuilder(500);
            int i = GetPrivateProfileString(Section, Key, "", temp, 500, this.inipath);
            return temp.ToString();
        }
        /// &lt;summary&gt;
        /// éªŒè¯æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        /// &lt;/summary&gt;
        /// &lt;returns&gt;å¸ƒå°”å€¼&amp;lt;/returns&gt;
        public bool ExistINIFile()
        {
            return File.Exists(inipath);
        }
    }
</pre>
<p>
	&nbsp;
</p>
:ET